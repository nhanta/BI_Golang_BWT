package texttobwt

import (
	"sort"
	"strings"
	"sync"
)

/*func main() {

	//text := "CGGGGAGTTTAGATCCTATGGCGAGGCAACTTCGTCCCCGACTGACATTTGAGTAACGCCGTCATATCATAGCTTAGCCACGGACGCCTACTTGAAGAATGCGAAAGCGGCTGCACGAGCTGTCCCTCAGCCTCACTCCATTATGGCCGGAGCGGTCAATGCACCCCACGCCAGGCTCTAAACGACGCACTGTAAAAACTAGGTTGCCGCTTAAGAGAAGAGTGTGTTTCGTGCTTAGTGCCCCCTATTGGCGCTAGCAGACGGCGTTCGCCCAGGTTTTTAACCGACCCAGCACGGCCGACCCCTAGAGGGATTAAATGGGCAGTTTGATGATGGGTGGGTAATAGTCGATGTGGGTGACGCCCTCTACGCTTGTTCCCGCATCACGTGTGGCTTTCCGTAGCCTGCAGAAACATCCATGGCAGGCATAAAACGGCCGATAAGTAGTGAAGAACTAGCTATTCCTCGCTTGGTATTCTCTTATGACTTACGGCATGATCTCCTTGTCAGAGAGCGATCGGGGTGTTCCGATGTTTCGTGAACACCTTTTAGTCAAGGGGGTTTTTAACGGTACGGGTGGACCTGAAGCAAGTGTGGTCCGTCCACAAGTATCTCGCTGAAAAGGCCCATGCGCGGTGCATTCAGCTGTATCCTCTGCCCAAAGCTTCATTCCCGGCCCGAGATAAGATGACGATTGCTCTCTAGCTATGAGGCTATGTGCTGTAGTGCCTGGTGTGTGAAAAAACCTTAATGCATATCACTCCATGGTAGCTATAACGACTAGACAGTCACGCGCGGACTATATAATTTTTTGTAGATCTGTTATACGTGGGATTTACCCGGCGAGATAGTGAGGGTTAATTCGTATCTTTCAACTGACTGGGTAGGAGATTT$"
	//text := "TCAAAAAAACTCCGCTGTACGGCTATCACCTATTGGTTTTCGGTGTTGTTCGGTTTGGCGGGTCTGCTCCGCGTCCCGTCCTGCAGCCGTGTCGGATTTCTTGCTTTCGCTGCCATCCCCTCTTATTATGTAGGTAATGATCATAGCGCCACCCGGGGTTTACCTGACTCGCCTCCGATCGACTAGTGCGCTATCCTACCGTGTATTCCACATCATTCTCGCGCGCCCTCGTTTGCATCTAAACTCATGCAAATAGTTATCATAGGGAAGTACGTCCCTCCACCGACTGCCCGTGAGCGCCAAACTCCTGACTCATTTGGTTAGATCTTTTTTTTCACTGAATGTGGTATAACTTGTGATGGGGGCCACCCGGCTTCTTTTTACCGTTTCTGGGGAGCCTTAGTATTAAAAAAAAATAATAAAAAAAGGTAAGGTTAGTACGGTCAAAGTTTAAACATACATTATTTCGCCTAACATTCATAGGGATTTACTATTTTTTGTTACTTTTAGGCCCAGTGCTGATACGTCCGCCTTGGGCAAACGTGGCCTCGTTTTCCGTTTTTGCTTAGCAGGCTGGTCGAAAACAAACCTAGGATGGGGATCTACTAGGACAGTTACGGCCCCCGCTGTTTCAACGCTATGACGCGCCTGCCTAAGCTACTATTGCCCCCATCACGGTCCGTCCAGGATAAGTTCCCAGCCCCGTACTTTTGGCGCCCTATCATGTCTTTTTGGCCGGCTCCGGACCAGGAAGAGTGGGGCCGTGCCAGGTCCAGCCTGGTGGTTACCGCCCGCGATCCTAACGACGTTACCGGGGAACATCCGGGCGTAGTGTTGTTAGACTCGCAAATACATTGCCTACGAGTGACAAAAAAGAATGTGCGTGCCAGTGGTTAACAGACGCGTATCCCCAGGCAGCCCGTATCGTGCGGGCGACCCGGCCAGCGCGGTTATTGATTATCAAACCCGGACTGGGGCGCTGCTAGAGTTGCTTTCGACTCGTCCTACCTTGATAGTCTTACGGGGGCTCTCCGGTTGAAGCCCGGAGCTCTCAAACGCACTCGGACTTTTAATCCTTTCCATCACCCCTGCCTTTCAGGTCATCTCTCTTTCTACCGCCACAACTTAATCCCTGGGATCACCGATCCTTTGAGCCGATTTTTTAAAAGTGCTGGTGGCTTTCTCTTGAATCATTTCGAAAAAATGCTCTTGCACCTTTCCTCGGCCGGCTTATGCTCATCTTGCCTCTTGTCTCTGTCTTACCTAACCAGGTGTCAACTGCTTCCTGCGTCCTGAAAAACCGGCGTTTCTTGGCAGATCACGTCGTTTTCACCCCAGCACATAAAGAGAACCAGCCGCCTTTACCAGGGTTCCGACCTCTCCAGCCTTCCCTTGGTTCAGGTTGGCTCAATTGCGCTCGAACGGATCATCGCAGGTGATGTTGTGCATTGTGGCCCCCCTCTGAAATTCCCTCTTTTATGCGTGTACGAGGGGTCGCTATGTTATTGAGTAAGTAAGCAGTACATAATCACATAACCAGTGCAAGACCCCCGGGACGACGGAGTCTGTGTGTAAGGGCCTCCCGCGCGGGATGGGGACGTCCTGACGTTGGTGTGATCGAATGCCCCACTTTTTGCCCCACCCGTGCACCCTTTTGGAGCGGTCTGAAGGTCTCAACTTAATCCTGTGCACGCGTTTAACTAGAATGCCGTATTCCGGGAATCGGGCTCCCGTTTTAGGCCGCCTTTTTCCCACGCGTGTCGCTTTTCACCCTTCGACGTATCTTTCCCCTGCCCTCTATGACGGGATCTAGCGTATTGAGTCTGCGCAACGATTCTTGTCCCACACCACGAATCTGTTAGCAACGTCCCGGTGTGTGCAAGTCCCGGTTACGCGGGGTCTGGGACTTCCTGCATTGCAGTCTGCGTGAGTTACCGTGCTTGTCCCGGAGCATAGCAGACTGGAGTCTGAGCGTAGTGGAGGGACACCGCCTCGTGTGATCTTGCAGCCCTTGCGCCTTAGTTAGGCTCGGCTTACAATCTCCCTCTATTCGTCCCTCCCCGCCCTCCATCGCTTAGTTCTGTTTTCGTTTCCTCGCCCCGTCGGTCGCTGACTTTCTCGTAAAAAATCATAGGCACTGAATGATCATCGATTCTCCAGCAAGGCCCGTACATAACTTGACTGAAGCCTCAGTAAGCGTCCCTACTACGCCTGCCGGGCACATTCCGCATCCGAAGGACACTTCATATAATAGCCCCCCGGCCAGCAGGTTTCCGAGGGCTGATCGGTCCACTCGGCCCGACGAGGTCCGAGTTTAGCCACATATAGTGAGAGCCGGGCCAAGGAAAATGTATCTGAGGCGAGTGTGCAGGCACTGAATGGGATACTGTTCACATTACCCAGTCCGAGGGTCTAGGGGGGGTACCCTTAGACGATCCACCATCCTCTCTTGATGGCCGCGGGCGCGTTGTCGAACCGTGTAGATTCTTCGGCCGGGGGGGGGGCTTTGTAGGGCTCCATGAGAGGGCGTTTGAGATCGACCTGCGGCTGCTCGAAAACCGAAGAGTATGGGGCCGAAGAACACAACAGTCAGCCCATATCTCGGTGCTTAAAACCTGCATCATACTCGGGGGGAGGCACGTCCCCCTGCTTGTCGGGATGCGTGTGCCTTGACCCTTTGTGAACCTCTTTTGACCATCCGGGCGGTCAAACGCCCTTTTCATATATTTTTCTAGACCAATCGCTCGGGGGTTTCCCGAGATCCGCTCGAGCGGCTTTCTTGCGTCCGTACATATGGCCCGAATTTCATGGTGGGTGGTCCCGGCGTGGGCGTACGGAAACCGTCCCGGGGTGGTTGCTCCATCGGCGGGATAGGGCTTGAGTTATAAAATATCAGTTCACCAGGCCTAGGTACGGGCGCTCGCGAGACCGAAAAGAACGGCAGACGATTAGCAACCCACAAAGCGAGGCTGCCCTTAGGGAACGCACCGCGGGGAAACAGAAGATGAATCTACTACACCAGGACCCTACAATACCAGCGGGGATCCACTGGAACCAATCCCGCTCTCTGACGTCGTAAAGACGCACAGACGAGGCAGCGCCTCTATGACATGTACGTCAGGATTAGTTTTTTTTTTGTG"
	//text := "banana$"

	t := "CTTGCATTATGGTTGTGCGTTTCTGATTTCTGATTTGCCAGAAGCTATCCAATTGGTTGAAGTTGAAAGTTGAAAACCCGTTACCCGGTATGCAGTACTTAATCCTTGATTGTACATACCGGTCATCAGTTATCTTCTACGTATCCAGCATCCAGCATCCAGCATCTTTCTGATTTCTGATTCTCGTACCCCGTCACTCCTCTGGATGGTGGATGGTGTCAGCAGTGTCGCGTGTGGTCAAAGGTCAAAGGGTATGCCCTACTTTCCTCGCACCCTGCTCCTCCTGCGGGGCACGGGGCACGGGACCTATCAGTGTGTCAGTAACACTTAACACCCCTGCTGATTCGTGAAGACCCACAACCCACAACACTGCAAGGATTAAGATATCGGATACACGCACGACGTTAGGGGGGCTCGGGCACGGAACGAGGAACGAGGACAAGACAGGTTGTGTATTTTGATTACATATGGATTCAGGATTCAGGCCGAAGATTGTGGTATGTGGTATGCCCGCCGACCTAGCTACGAGCTACGAGCTATAGTACATAACACCTGACACCTGCTTCTCCCTCTTATAGCTTATAGCGCAGCTGTTACCGATTACCGATCCAACGCCCAACGCCCTGTTTCTCCACTTGGCATTGAATCGTGTGGCGCAAGGGGTCATTCGGCATTCGGCAGAAAAGTAACACTTAACACTTTTGTTCTTTGATATATTATATATTATACAAAACGCAATAATAGATGTCACACGTCGGCTACGAGCTTGGATGGTGAGCTTCCAGTAAGTCTTAACAGAGGGATTCAGGATTCAGGGAAATTCCGACTATCAGTTATCGCCTGGAGTTCTACTTAGATCTTAAACGGGAAACGGGAATAGTTACGAGTTGATGCGCTTAAAACCCCCCACCTGTGTCGCGTGCCATGTTAATCGGCAATCCGTGGTCCGACTACACTCTACACTCAACCCTTAACCCTACGATGTACGATGGAGATCCTAGGCTGTTTAGCGTTTAGCGTGTATTGTCCCAGGGCCACATACACAATACACAATACACCGTTAGGCGGCTTGCGGTGGTAGGTTGTACCATGTACGATCTAGCTGCCAAGCGACAAATGCACACAACCTACAACCTTTATGAAAAATGATATCACCTCTCGTCTACGGGACCCGGGACCCGGGATCCTGCATTATGAAGTGAAAATCTTTAGTCTTTAGTCCGGGAAGTCTCTCGTGTCTCGTGTCTCTCAACTAAGTTATGAGCTTATAGCTAGCGCCGTGTCGCGTGTCGCGCTAGAGCCTAGAGCCTTGTCGCGTGGAGCACGGAGCACGGAATGGCACCTGGCACCTGCGTGCCTCGTGCCTCGAAGTTCCAAGTTATCGGCCTTCGCCCTATGGGGAGTGGGGATACCCGTTACCCGTTACACGAGGCGTAACGCCCTTGCGCCTTGCGCCAAGTCTTAACTTGTGTTTACGAAGGACTTGGCGGTAACTAAACACCCGTGAATGCAGAATGGCTTGGTGTCGCGTGTCGCGTGGCCCTTGGATGGTAATACATAATACATATTTAGTTCCTACTTCCTACTTCCACACGCATACACGTTCGACTGCACTTCGGCCTTCTCATCTTGCATGTGCGACGTGTCGCGTTCGGTGTGGCGTGGAACATCGAGAAGGAGATAGGAGATAGAGGCCCTTGGCCTTGCGTGCCTTATGCCTTATGTGTGAAATGATATGGTATATGGTATGGGAGTCACGCTTAATCCTTAATCCTCCTTAACCCTTAGAACTAGAGCCTGATTCGTGATTCGTGAACATATGCCCTATGCCCTAGATCCCCTCCTCTGTCCTCTGGGACCCGGGACCCGGCCTTACACGGTACACTCCCAGCTAATACATAATATGACTCATGTTCAGGGAGCGGCGAGCGGCCGCGAGTCCTTAATCTCTTTAGTCCCGAGCACCGAGCGGAGGCTGGATCATGAATCATGAATCTTAGATCTTAACAACGAACAACGAAATATGGGATATTTGCGGGTTCACAATACACAATACAAACGTGGGGCTCAATTCGAAAAGCGACCCGTTTTTCGACCGACGCGAAACGCGAAACGCGCGTTGACTCATGCCTGTTCAACGGGAACAGTGGCCCTTACACAACACAGCGCGGCCAGTGGCCAGACGGGTGCAAGGAGCTAGTCGTTACGAGTCAAAGCACCTGATCATCTCTCATCTCTCAACAGCATTTACTTCCGCCGACCTACAGCTTACGTACTAAACACCTTGACCATAATAGATGGAACGACTCTCACTATTGTACATTAGCGTCACCCACAACAAGAGATCCTAGATCCTAGCACCCAGAGAAGTTGAAAGTTGAAATGTCTACTGGCCCGAGGCCATGTCGTCGACTTTTGACAAGTGCAAGTCACCTTGCACCTTGCACCACCCAACATTGTGAAAAATGAAAAATGTGTTAGCAGTCTCACATACCACGTAAAACGGTCACTCCTCACTCCTCGATATCGGTTACAGCTTAACCGGCGACTGCAAGTGACTCTAAGCTTTTGCGGTGCCGCTGTGCCGCGTACCGTCCACTCTCCTTTCCAAGTTAGTGAAAACTTCGGTGACACAGCACAATGGAATTCACCCATTATCCATTTTTCATTATCGGCCGTGGGCCGTGGGTATGATTCGTGATTCGTGAACCCAGGGCCCAGGGCAGTTACCAAAAACGTTCGACGTACCTTGCAGGGTGACCTCCCGGAGCACGGAGCACGGTCAGCGGTCAGCGGCCGGCGACCGGCGACCTTACCGCTTGAAACCCTAAAGGGTCATTCGGCATCCTCCATCTAGCATCTAGCATGAACGCCGAAAAATGGCACAGCACACAGCACATAAAATGTTTAAGTAGCTGACACTTAGATCTTAGATCTACGTGCCGCGTGCCGCGTCACCTTGCATACTTCCGCGATCTGGGATCTGTACCTTGCGAGACAGGAGCACTAACCACTAACCACGCACCGACATTGACTCGTAAAGCAATCTGACGATGTACGATGTACCACGTTAGGGTCGACCGTCGACCGTGATATAGGATATAGGATATGGGATATTAGCAATGTGCCCTATGTTATCTTGTGGGTTTGGGGAGAGTGTAAAGTGTAAAGTTCCGAGTTGGTACCTTCCCCCCTTGGTTCAATGTTATATTATAAATATACAATATAGTTCGCGTCTCCATGAATCGCATATGGTATCCGACTACCGGATATCGGGACGTGAAATGTGAAATGTTTCTTTCTGATTTCTGATACTAACCACCTCACCGCTGTAATTGAGTATTGGTTCCAGGCTCGTAACATGTACCGTTTTACTACCTACTACCTACGTCGTTACGAGTTGGTTATGCCCACCTTGCACCTTGCAATTGTACATTGTACATTGCTTGAAAGCGACAAGCGACAATTTCTCGAAACCATTTTGAAAAATGAAAAATGCCTCGGTAGGGGAAAGAGCATAGCGGACTGACTAAGGATTAAGGATTAATAGTTTGGGTCTTTAGTCCCACACCATCACACCTTGCAGTACCCAGTACCCACGAGTGGCGAGTGGAAGTCTTAAGTCTTAAGAAGAGCATAGAGCATCTGCCGCCTGCCGAACAACGAACAACGAAGTAGAATGTAGAATATATCGTGTGTTACGAGTTACGAGTGTCACTCCTCTTCAGTAATTAGTCATCTTCTCCCTCGGCATATCTACGAGCTCGATTACGCATTACTAGAGCCTGCACAATACAGTCCGCCCTGCTCCGGATTCAGGCACCTGACTAGTAACAAGGTCAAAGGACTAAGTGATAACGTATGCCCTATTGGATGGTGGCAAGTACTACCGTTTAGCGTTTCAGCTACTTTTGACTTTTGACCAAGGCCACAGCACACAGCACATTGACAGTTGATTATAGCTTATAGCATTTTTTAATGGTACCTGGCACGGCGCAATAAGTGATACATTCAATGTTCTTATAAGTTATTGTACATTATCCTACTTCGTACTACCGAATACCGAATACAACGCCCTTGCGCCTTGTACCTTGTACCTTGGCCGAAAGCAAATCCACTTTCCCGCTTCTAATACATAATACATAATCTTCGGAGACTAGACGAGCGACGAGCGATCACGTCGGTAGTGGTACATACCAATAAGATCTTGGCGTGCCTCGTGCCTCGTGTGTCGTGTGTCGTGGAGAGCATAGCTGGTAGGTCCCAGGGCCCAGGGCCGGCCCGTAAGCCGTAAGCCGTCGAGGCTCATCTCGTATCTCGTGTGTCGTGTGTCGTTAATCCGGTTTCCCCTTGGCACCTGTTGTTTCTTCCAACACCGCGTGTCAAAACGGGAAACGGGAAAGTAGACATTGTACATTGTACATGTGCCTCGCTGCCACACGCCTAGACATGTTGAAAAATGAAATTACAGCTTACAGCTTAGACCCCCCAAAACGGGAAACGGGAAAATCTGACTAACCACTAACCACTGGCGAGCGTAAGCCGGATAGTTCGACTTGAGCACCGAGCACGGGTATAGGTAGTTGGAAACGTACCGGGTATAGGGTATAGGTAATACCACATGTTACTTGTGTATTGTGTATTGCCGCGGGTGAGTTGGACAGAGGACAGAGGATCGTTCAATGTTTAAATAACACTTAACACTTACGCAAGGAATACTTGATAACGCTGCCGCCTGCCGCCTCAAGACATTACGCATTGCAGAATGCCGGTCACCGGTCATTATCACTTGTCCTGTCCTCTGTCCTCGACAAATCCTCACGCACGACGGCCTGAATTTTTTCAGTTTACCACTTGCGACCCGCTGGAGTATCTTGGATATAGGATAACCCACGAAGACAGGAGACAGGAGCGACGGACAACTAGAGCCTAGAGCCTGATCTGGTCAGCGGGTCACTCCTCCCCTATGCCCTAACACAGTTACCAGTTACCACGACAATGGACAATGGAAAAAGCCGAAACGATGTACTAATGACTATGTAGAATTAGAATCCTTTCCTGTTAATCGTGTCTCGTTGCAAGTAGCAGGGGGGCGGTATGCAGTATGCAGTCTTATAGTAACACTTATCTGCCTCGTTTTGCGCTTCAGGTTCTCCTAGATACCAGATACCAGCATGGACCCGGGACCCGGGGTATGTGGTATGCCAGTTACAATATACGCCAGGTGCAAGGGACGAGCGAAAACACACGGATACGATATAGGAGATCAGTACCCAGTACCCAGAGTTTCTCAAGTCCAGAGTCCACACGTGCTCGAGAGGGGAGATTGTTCTCCGCCGACCCTGTCGTCTCCCAGGCCCATACCGAACGTAACAACGAACAACGAACCTGCTCCCTGCTCCCCAAATCTTTGTTCTTTGTTCTTTTACTGAGTATTGGTGTGAAGAAAGCCGAAAGCCGAAAAAATGGTAAATGGTGGTTTCCTGTTTCCTGTTCGGTAACTAAACACTTAAGGATTAAGGCGGTTCTTTCTCTTTCGTGTCGCGTGTCGCGTGCCCTTACATATTATCTATGTATTGGGATCCGCCGACCCCTTATGTGGGATATGGGATATGATGTAGAATGTCATAAGTTATGGCACATACCAGGGACGGTTCCATCAGAATGTTTAATGTTTAATTCCCCCTTCCCCTCTTTAGTCACACCATTCGTCTCTGTCTCCAGCATCCAGCATCCTTTATACTTCACAAGGATTAACTGAATATGGTATCTTCAATACAAAATCCTCAATCCTCAAACTCACTCGTACCGGCGACCGGCGACGACGTGCCCTGCATTATGCATTATGCGATTCGTGTCATTACGCATTACGCATGGCGAGCGGACAATGAGATACCAGATACCAGTTTAGTTGCTTACGGTTTGTTCAATGTGGCACTTCTTTAGTCTTTAGTCGTGATAGTCGGTAGTCTCAAGACTTCACTTGTCACTTGTCATCGCTATGCACTCAATGTTCTCAACCGGAGGATGCGTGACGCATTTACCATTTTGACTCATGTGCGCCTATAAGGATTAACATCCTTCGGCTAAAGGGCTTTTACTTGATCCTACTTCCTACTTCCAGGTCAAAGGTCAAAGGATGACTCATGCAGGCTCTAAGCGACAATTGCTGAGTCCAATCTCAATTCGTGAGGCGTGAGGCATCTTTGGGAGCAGCGAGATTCGTGATTCGTGAAGATAACCGATAACCGACTGAGTTGCGGTCTATTCAGTATTCACACCTTGCAGCGACTCGACGTTAGGCTCGAGACTTTTGGTAAACCGTTTCTTTATTCTTGCTTAACAACGAACAACGAACAGGGGAGCAGGTAACACCTAATCGACAATGGACAATGGAACATACGTCATCGAGTCGCGAGTCGCAATAATAGATCTCATTAGACAACCGGTCAAAGGTCAAAGGTAGACTACGAGCTAGTATTGTTGATTATTCAGTATTCAGTATGAATCATGATAACACTTAAGGTTTTAAATTCGAAATTAACCGTAAGTGATACTGTGTGTCGTGTGATTGGAATGTGTCGCGTGTCGCGTATACAGCACTTCTCCCTTGACGAGCGAGATAGAGGTGGGAGGCCCTGCTCCCTGCTCCCGGTCAATCCCGCTTCCCGCTTCCCTACTTCCTCCTTAGTCCGTACGATTTCCTGTTTCCTGTTGTTCTGTGCTGTGTTGACTCATGTAATGACTGTGCAGAGTGCAGATGGTTATAGGTTATAGGCATCTAGCATCTAGCATCCCCCCGGTTTGGGGTGGCTAATGTTTAATGTTTAAAGCACGTGTAATCATGAATCATTACGCATTACGCATCGAGCAGGGCGGATATTTCAGTTTATCTCGTAGACTTGGGAGCCTGGCCATATTAGGTCAAAGGTAGAGCCTGGGACCCGGGGGGCGGGGTATGCAGTATGCAGTCGGTAGTCGGTAGTCGCAAGGCGCAAGGGTGCAAGAGTCCGCCGGACGCCGGACGTATATTATATATTATACAGGTTTTCTGATTTCTGATTGGGAGGGGCTCGCCGACTACCGACTACCGGGGTAGCCCTGGCATCTGTCAGCAGAATTTATAATTTATAAGTGTCTTAGTCATTGGGATGTAGAATGTAGAATGTCAGCAGTCTGTTCTATACTAACGCACGAAAGTCTTAATGCCGCGTTAGAATGCGTTGATATAGGATGGGGGGGCATTACGCATCACCGAACCGAATCTAGCATCCGGCCTGCTTATAGCGTTGAAGCCGTTACCGCTTACCGCTTGACCAGCGCACGGTACACGGTACGGTCAGCGGTCAGCGGATATGGTATCTCTCAATTCTCATAATAGATCCGCGTTCACTCCTCACTCCTCCTCCCTGAGCATAGTGATACTTGATACGCAGGGACCACACGTTTTGCGTTGGGACCCGGGACCCGGGTGCAAGGTGCAAGGTTAGCGTAGTACCCAGTACCCATCTGGAAGTCTTAAGTCTTAATCGTGTCTCGCGCCGGACGGTAACTTACCGCTTACCGCTTACCGGATACATGTAATCCTCTGTCAACGCCGAAGTCCTTAGTCCCCTTGGCACCTGGTCAGCGGGTACAGCTGTAAACCGTATGAGGCTGTTGGATCTTCCGACTACCGACTACCGATTTTAATTTGCAACATGGCCGTGGGCCGTGGGCGTCCCTTATCACTTATCACAATTCGAAATCAGCGGAGTGCCATCTGTGGCTTTGTGGTACTAACCACATACATAATACATAGTACGCGCCAGTGCTTGTTTGACTGATTCACTTGTCACTTGTCTAAGTGTCAGTTATCCCTGTGGTATGTCTTGCGTTGTTCTTTGTTCTTTTAGATGGACGAGCGAAACGCACCTGATACTACTGCCGCCTGCCGCCTCTAGGTCAGCGGTTGAGACAGGACAGATCAAGCGACAAGCGACAATCGTCCAGTTACCAGTTACCACGAGCCGAGCACCAAACGGGAACGCGGCTCTGGTTGGTACCTGGTACCTGATGGACGATGGACGACGCTGCCGCCTCCCCACGATGTACGATGTACCTTAGTCCCCAGGCCCCCCCCGAGGCTGGAGGCTGGACGGGTGCAAGGAGATCCTAGCTACTCCTCCAGGCTCAACAGGATATATAATAGATGTGCCGCGTAAACACACCTTGACGCCCGGCCGCGGGCCGCGGCTAGT$"

	var text string
	for i := 0; i < 80; i++ {
		text += t
	}

	/*data, err := os.Open("ecoli.txt")
	if err != nil {
		log.Fatal(err)
	}
	defer data.Close()

	b, err := ioutil.ReadAll(data)
	text := string(b)

	fmt.Println("Length of gene: ", len(text))

	start := time.Now()
	str := getBWT(text)
	fmt.Println(str)
	fmt.Println("None Concurrency---", time.Since(start), "---")

	sta := time.Now()
	c := getBWTConcurrency(runtime.NumCPU(), text)
	fmt.Println(c)
	fmt.Println("Concurrency ---", time.Since(sta), "---")

}*/

// Get BWT from text with sequential algorithm.
type Slice struct {
	sort.StringSlice
	idx [] int
}

func (s Slice) Swap(i, j int) {
	s.StringSlice.Swap(i, j)
	s.idx[i], s.idx[j] = s.idx[j], s.idx[i]
}

func NewSlice(n [] string) *Slice {
	s := &Slice{StringSlice: sort.StringSlice(n), idx: make([]int, len(n))}
	for i := range s.idx {
		s.idx[i] = i
	}
	return s
}

func GetBWT(text string) string{

	// Declare variations.
	var textList [] string
	var bwt [] string

	l := len(text)
	// Creating suffix array
	for i := 0; i < l; i++ {
		textList = append(textList, text[i:])
	}

	s := NewSlice(textList)
	sort.Sort(s)
	suffixArr := s.idx
	// s.StringSlice
	// Get Burrows - Wheeler transform.

	for j := 0; j < l; j++ {
		bwt = append(bwt, string(text[suffixArr[j] - 1]))
	}
	return strings.Join(bwt[:], "")
}

// Get BWT matrix with concurrency algorithm.
func GetSuffixArray(goroutines int, text string) <- chan map[int] string{
	// Algorithm in CPUs Bound type, so we can run parallel all sub-algorithms.
	// Device algorithm in goroutines.
	l := len(text)
	lastGoroutine := goroutines - 1
	stride := l/goroutines

	var wg sync.WaitGroup
	textList := make(chan map[int] string, l)

	wg.Add(goroutines)
	// Run concurrency algorithm with routines.
	for g := 0; g < goroutines; g++ {
		go func(g int) {

			start := g * stride
			end := start + stride
			if g == lastGoroutine {
				end = l
			}
			// Synchronise output of suffix array.
			for i := end - 1; i >= start; i-- {
				textList <- map[int] string {
					i: text[i:],
				}
			}

			wg.Done()

		}(g)
	}
	wg.Wait()
	close(textList)
	return textList
}

// Get BWT from BWT matrix.
func GetBWTConcurrency(goroutines int, text string) string {

	l := len(text)
	v := GetSuffixArray(goroutines, text)
	var lst [] string
	var keys [] int
	var bwt [] string
	patterns := map[int] string {}
	var mu sync.Mutex

	// Read value from channel of suffix array.
	for str := range v {
		mu.Lock()
		for k := range str {
			patterns[k] = str[k]
		}
		mu.Unlock()
	}

	// Sorting original suffix array, after it's order is changed order by concurrency channel
	for k := range patterns {
		keys  = append(keys, k)
	}
	sort.Ints(keys)
	for _, k := range keys {
		lst = append(lst, patterns[k])
	}

	s := NewSlice(lst)
	sort.Sort(s)
	suffixArr := s.idx

	// Get Burrows - Whealer transform.
	for j := 0; j < l; j++ {
		bwt = append(bwt, string(text[(suffixArr[j] - 1 + l) % l]))
	}
	return strings.Join(bwt[:], "")
}

